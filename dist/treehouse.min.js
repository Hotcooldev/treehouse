!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r;(function(i){"use strict";function u(t){return t&&t.__esModule?t:{"default":t}}var a=n(1),s=u(a);i.define&&n(17)?(r=function(){return new s["default"]}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))):i.module&&t.exports?t.exports=new s["default"]:i.treehouse=new s["default"]}).call(e,function(){return this}())},function(t,e,n){(function(r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(t,e,n){for(var r=!0;r;){var i=t,u=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,u);if(void 0!==s){if("value"in s)return s.value;var o=s.get;if(void 0===o)return;return o.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return;t=c,e=u,n=a,r=!0,s=c=void 0}},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(2),l=i(c),f=n(5),h=i(f),d=n(6),p=i(d),v=n(7),y=i(v),g=n(10),b=i(g),m=n(13),k=i(m),w=n(14),_=i(w),O=n(15),j=i(O),M=n(16),P=i(M),x=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,t),this._tree=e,this.dirtyTracker=new j["default"],this.actions=new _["default"](this),this._mutators={},this.queries=new y["default"](this),this.filters=new b["default"](this),this.Cursor=function(t){function e(){a(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return u(e,t),e}(l["default"]),this.registerMutators(h["default"]),this.registerMutators(p["default"])}return o(t,[{key:"tree",value:function(){return this._tree}},{key:"setTree",value:function(t,e){this._tree=t,this.dirtyTracker.markChannelDirty(e)}},{key:"init",value:function(t){this.setTree(t)}},{key:"trunk",value:function(){return this._trunk=this._trunk||this.at([])}},{key:"at",value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),new this.Cursor(this,e)}},{key:"registerQueries",value:function(t){this.queries.register(t)}},{key:"query",value:function(t,e){return this.queries.build(t,e)}},{key:"registerMutators",value:function(t){Object.assign(this._mutators,t);for(var e in t)this.Cursor.addMutatorMethod(e)}},{key:"mutators",value:function(){return this._mutators}},{key:"registerFilters",value:function(t){this.filters.register(t)}},{key:"buildFilteredStream",value:function(t,e,n){return this.filters.buildStream(t,e,n)}},{key:"pick",value:function(t){return new k["default"](this,t)}},{key:"registerActions",value:function(t){this.actions.register(t)}},{key:"action",value:function(t,e){this.actions["do"](t,e)}},{key:"commit",value:function(){this.dirtyTracker.cleanAllDirty()}},{key:"extendReact",value:function(t){t.treehouse=this,Object.assign(t,P["default"])}},{key:"log",value:function(t){r.console&&r.console.log&&r.console.log(t)}}]),t}();e["default"]=x,t.exports=e["default"]}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),s=r(a),o=n(4),c=r(o),l=function(t,e){var n=void 0,r=t;for(n=0;n<e.length;n++)if(r=r[e[n]],void 0===r)return;return r},f=function d(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?0:arguments[3];if(0==e.length)return n;var i=(0,s["default"])(t),u=e[r],a=void 0;return a=r+1<e.length?d(i[u],e,n,r+1):n,i[u]=a,i},h=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];i(this,t),this.app=e,this.path=n,this.mutators=this.app.mutators()}return u(t,[{key:"get",value:function(){return l(this.app.tree(),this.path)}},{key:"set",value:function(t){var e=this.get();if("function"==typeof t&&(t=t(e,this.mutators)),void 0===t)throw new Error("You tried to set the tree at path '"+this.pathString()+"' with undefined");t===e&&this.app.log("You tried to set the tree at path '"+this.pathString()+"' with the same object. Remember the tree should be immutable");var n=f(this.app.tree(),this.path,t);return this.app.setTree(n,this.channels()),this}},{key:"setWith",value:function(t){for(var e,n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];return this.set((e=this.mutators)[t].apply(e,[this.get()].concat(r))),this}},{key:"at",value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return Array.isArray(e[0])&&(e=e[0]),new this.constructor(this.app,this.path.concat(e))}},{key:"channels",value:function(){return this._channels=this._channels||[this.path[0]]}},{key:"pathString",value:function(){return this.path.join("/")}}]),t}();h.addMutatorMethod=function(t){this.prototype[t]=function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];this.setWith.apply(this,[t].concat(n))}},(0,c["default"])(h),e["default"]=h,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){return Array.isArray(t)?t.slice():Object.assign({},t)},t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){t.prototype.filter=function(t,e){return this.app.buildFilteredStream(t,this,e)}},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),u=r(i);e["default"]={push:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return u["default"].clone(t,function(t){t.push.apply(t,n)})},concat:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return t.concat.apply(t,n)}},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),u=r(i);e["default"]={clone:function(t,e){if(e){var n=(0,u["default"])(t);return e(n),n}return(0,u["default"])(t)},merge:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return Object.assign.apply(Object,[{},t].concat(n))},setAttribute:function(t,e,n){return this.clone(t,function(t){t[e]=n})},"delete":function(t,e){return this.clone(t,function(t){delete t[e]})}},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(8),s=r(a),o=function(){function t(e){i(this,t),this.querySpecs={},this.app=e}return u(t,[{key:"register",value:function(t){Object.assign(this.querySpecs,t)}},{key:"build",value:function(t,e){var n=this.querySpecs[t];if(n)return new s["default"](this.app,t,n.deps,e,n.get,n.set);throw new Error("Can't build query '"+t+"' as it's not defined")}}]),t}();e["default"]=o,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(9),s=r(a),o=n(4),c=r(o),l=function(){function t(e,n,r,u,a,s){i(this,t),this.name=n,this.app=e,this.treeView=e.pick(r||{}),this.args=u,this.getter=a,this.setter=s,this.state=null}return u(t,[{key:"get",value:function(){var t=this.treeView.get();return this.state&&(0,s["default"])(this.state,t)||(this.result=this.getter(t,this.args),this.state=t),this.result}},{key:"set",value:function(t){if(!this.setter)throw new Error("Query '"+this.name+"' doesn't implement set");this.setter(t,this.treeView.items(),this.args)}},{key:"channels",value:function(){return this.treeView.channels()}}]),t}();(0,c["default"])(l),e["default"]=l,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){return t&&t.equals?t.equals(e):t==e};e["default"]=function(t,e){if(Object.keys(t).length!=Object.keys(e).length)return!1;var r=void 0;for(r in t)if(!n(t[r],e[r]))return!1;return!0},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(11),s=r(a),o=n(12),c=r(o),l=function(){function t(e){i(this,t),this.app=e,this.filters={}}return u(t,[{key:"register",value:function(t){var e=void 0;for(e in t)this.filters[e]=new s["default"](e,t[e])}},{key:"buildStream",value:function(t,e,n){return new c["default"](this.app,e,this.find(t),n)}},{key:"filter",value:function(t,e){return this.find(t).forward(e)}},{key:"unfilter",value:function(t,e){return this.find(t).reverse(e)}},{key:"find",value:function(t){var e=this.filters[t];if(!e)throw new Error("Can't find filter '"+t+"' as it's not defined");return e}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function i(t,e){var r=this;n(this,i),this.name=t,"function"==typeof e?(this.forward=e,this.reverse=function(){throw new Error("Filter '"+r.name+"' doesn't implement reverse")}):(this.forward=e.forward,this.reverse=e.reverse)};e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(4),s=r(a),o=function(){function t(e,n,r,u){i(this,t),this.app=e,this.source=n,this.filterObject=r,this.args=u}return u(t,[{key:"get",value:function(){return this.filterObject.forward(this.source.get(),this.args)}},{key:"set",value:function(t){this.source.set(this.filterObject.reverse(t,this.args))}},{key:"channels",value:function(){return this.source.channels()}}]),t}();(0,s["default"])(o),e["default"]=o,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r){n(this,t),this.app=e,this.dirtyTracker=e.dirtyTracker,this.streams="function"==typeof r?r(this.app):r||{},this.callback=null}return r(t,[{key:"channels",value:function(){var t=this;return this._channels||!function(){var e=[],n=t.streams,r=void 0;for(r in n)n[r].channels().forEach(function(t){-1==e.indexOf(t)&&e.push(t)});t._channels=e}(),this._channels}},{key:"items",value:function(){return this.streams}},{key:"watch",value:function(t){var e=this;this.callback=function(){t(e)},this.dirtyTracker.track(this.callback,this.channels())}},{key:"unwatch",value:function(){this.dirtyTracker.untrack(this.callback,this.channels()),this.callback=null}},{key:"markClean",value:function(){return this.dirtyTracker.markClean(this.callback),this}},{key:"get",value:function(){var t={},e=this.streams,n=void 0;for(n in e)t[n]=e[n].get();return t}},{key:"set",value:function(t){var e=void 0,n=this.streams;for(e in t)n[e].set(t[e])}},{key:"setter",value:function(t){var e=this;return function(){return e.set(t)}}}]),t}();e["default"]=i,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e){n(this,t),this.actions={},this.app=e}return r(t,[{key:"register",value:function(t){Object.assign(this.actions,t)}},{key:"do",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(this.actions[t]){var n=this.app.commit.bind(this.app);this.actions[t](this.app.trunk(),e,n),n()}else this.app.log("Action '"+t+"' not found")}}]),t}();e["default"]=i,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){n(this,t),this.all=new Set,this.channels={},this.dirty=new Set}return r(t,[{key:"channel",value:function(t){return this.channels[t]||(this.channels[t]=new Set),this.channels[t]}},{key:"track",value:function(t,e){var n=this;this.all.add(t),e.forEach(function(e){return n.channel(e).add(t)})}},{key:"untrack",value:function(t,e){var n=this;this.all["delete"](t),this.dirty["delete"](t),e.forEach(function(e){return n.channel(e)["delete"](t)})}},{key:"markChannelDirty",value:function(t){var e=this,n=t?this.channel(t):this.all;n.forEach(function(t){return e.dirty.add(t)})}},{key:"markClean",value:function(t){this.dirty["delete"](t)}},{key:"isDirty",value:function(t){return this.dirty.has(t)}},{key:"cleanAllDirty",value:function(){var t=this;this.dirty.forEach(function(e){e(),t.markClean(e)})}}]),t}();e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),u=r(i);e["default"]={action:function(t,e){this.treehouse.actions["do"](t,e)},componentWillMount:function(){this.treehouseState&&(this.treeView=this.treehouse.pick(this.treehouseState.bind(this)),this.treeView.watch(this.syncWithTree.bind(this)),this.syncWithTree())},componentWillReceiveProps:function(){this.syncWithTree()},syncWithTree:function(){this.treeView&&this.setState(this.treeView.get())},shouldComponentUpdate:function(t,e){return!(0,u["default"])(this.state,e)||!(0,u["default"])(this.props,t)},componentDidUpdate:function(){this.treeView&&this.treeView.markClean()},componentWillUnmount:function(){this.treeView&&this.treeView.unwatch()}},t.exports=e["default"]},function(t,e){(function(e){t.exports=e}).call(e,{})}]);